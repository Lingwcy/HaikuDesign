# 第一章：为什么需要测试？

## 什么是测试？

测试是一种**验证代码正确性**的手段。就像考试一样，我们通过测试来确认代码是否按预期工作。

## 为什么组件库需要测试？

### 1. 防止回归 (Regression)

> 回归：指新代码破坏了已有的功能

```
你修复了一个 bug，三个月后另一个人改动了代码，
那个 bug 可能又会出现——这就是回归。

测试的作用：在 bug 修复后写下测试，确保它永远不会再次出现。
```

### 2. 文档作用

测试代码就是最好的文档：

```tsx
// 看这个测试，你知道 Button 应该：
// - 能渲染 children
// - 支持 disabled 状态
// - 点击会触发 onClick
it('handles click events', () => {
  const handleClick = vi.fn()
  render(<Button onClick={handleClick}>Click</Button>)
  fireEvent.click(screen.getByRole('button'))
  expect(handleClick).toHaveBeenCalledTimes(1)
})
```

### 3. 信心保障

```
发布新版本前，不需要手动测试每一个组件
→ 运行测试 suite → 全部通过 → 放心发布
```

### 4. 改进设计

> 测试驱动开发 (TDD)：先写测试，再写实现

- 如果一个功能很难测试，通常说明设计有问题
- 测试迫使你写出更清晰、更可维护的代码

## 测试金字塔

```
        /\
       /  \      E2E (端到端) - 少量
      /----\     数量少，成本高
     /      \
    /--------\  Integration (集成) - 适量
   /          \ 测试多个模块配合
  /------------\
 /              \ Unit (单元) - 大量
/________________\ 速度快，成本低
```

对于组件库：
- **单元测试**：每个组件的独立行为 (最多)
- **集成测试**：组件之间的配合
- **E2E**：整个文档站的交互 (最少)

## 小结

| 收益 | 说明 |
|------|------|
| 防止回归 | 修复的 bug 不会再次出现 |
| 文档 | 测试即文档 |
| 信心 | 发布前自动验证 |
| 设计 | 促使写出更好的代码 |

下一章，我们将安装测试依赖并解释每个包的作用。
